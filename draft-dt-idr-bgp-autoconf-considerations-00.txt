



Network Working Group                                            R. Bush
Internet-Draft                  Arrcus, Inc. & Internet Initiative Japan
Intended status: Informational                                   J. Dong
Expires: January 10, 2021                            Huawei Technologies
                                                                   X. XX
                                                            July 9, 2020


     Requirements and Considerations in BGP Peer Auto-Configuration
              draft-dt-idr-bgp-autoconf-considerations-00

Abstract

   This draft is an exploration of the requirements, the alternatives
   and trade-offs in BGP peer auto-discovery at various layers in the
   stack.  It is based on discussions in the IDR WG BGP Autoconf Design
   Team.  The current target environment is the datacenter, while it is
   considered by the design team to not to preclude the work on WAN
   deployment in the future.  This document is not intended to become an
   RFC.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 10, 2021.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect



Bush, et al.            Expires January 10, 2021                [Page 1]

Internet-Draft    Trade-offs in BGP Peer Auto-Discovery        July 2020


   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Backgrounds and Requirements  . . . . . . . . . . . . . . . .   2
     2.1.  The Scope . . . . . . . . . . . . . . . . . . . . . . . .   3
     2.2.  Assumptions . . . . . . . . . . . . . . . . . . . . . . .   3
     2.3.  Summary of Requirements . . . . . . . . . . . . . . . . .   3
     2.4.  Simplicity  . . . . . . . . . . . . . . . . . . . . . . .   4
   3.  Operator Configuration  . . . . . . . . . . . . . . . . . . .   4
   4.  Considerations on Design Principles . . . . . . . . . . . . .   4
   5.  Analysis to Candidate Approaches  . . . . . . . . . . . . . .   5
     5.1.  BGP Peer Discovery at Layer Two . . . . . . . . . . . . .   5
       5.1.1.  LLDP based Approach . . . . . . . . . . . . . . . . .   5
       5.1.2.  L3DL based Approach . . . . . . . . . . . . . . . . .   6
     5.2.  BGP peer Discovery at Layer Three . . . . . . . . . . . .   7
       5.2.1.  New BGP Hello Message based Approach  . . . . . . . .   7
       5.2.2.  BGP OPEN Message based Approach . . . . . . . . . . .   8
     5.3.  Discovery at Layer Seven  . . . . . . . . . . . . . . . .   8
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .   9
   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   9
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   9
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .   9
     9.2.  Informative References  . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  10

1.  Introduction

   This draft is an exploration of the requirements, the alternatives
   and trade-offs in BGP peer auto-discovery at various layers in the
   stack.  It is based on discussions in the IDR WG BGP Autoconf Design
   Team.  The current target environment is the datacenter, while it is
   considered by the design team to not to preclude the analysis of WAN
   deployment in the future.

2.  Backgrounds and Requirements

   Previous discussion in BGP autoconf design team converged on a number
   of aspects of the BGP auto-configuration problem.







Bush, et al.            Expires January 10, 2021                [Page 2]

Internet-Draft    Trade-offs in BGP Peer Auto-Discovery        July 2020


2.1.  The Scope

   The current target environment has BGP used as the underlay routing
   protocol in data center network.  While it is also considered by the
   design team to not to preclude the work on WAN in future.

2.2.  Assumptions

   o  BGP OPEN message will do the heavy lifting in BGP session
      establishment.

   o  Before BGP OPEN message is sent, there is BGP auto-discovery and
      there is choosing peers.

   o  BGP auto-discovery should not do anything that could be done by
      BGP OPEN message.

   o  BGP peering could be selective, every BGP speaker may not want to
      peer with every other BGP speaker.

   o  BGP speakers does not know the potential peers' IP addresses and
      AS number.

   o  After BGP auto-discovery, it would be nice if another exchange was
      not needed before BGP OPEN.

2.3.  Summary of Requirements

   The set of requirements that have been agreed by the design team are
   as follows:

   o  Support IPv4 and IPv6 address families, but do not assume both are
      available.

   o  Support discovery of the peering IP addresses for the BGP session
      endpoints.

   o  Support using either a device's interface address or one of its
      loopback addresses for the BGP session endpoint.

   o  Support discovery of the peers' ASs.

   o  Support discovery of the set of possible peers, and optionally
      each one's attributes, which can be a deployment defined set,
      e.g.: leaf, spine, ice cream flavor, etc.  These attributes are
      arbitrary and operator dependent.  No assumptions about this
      should be made, code points assigned,, etc.




Bush, et al.            Expires January 10, 2021                [Page 3]

Internet-Draft    Trade-offs in BGP Peer Auto-Discovery        July 2020


   o  Support to agree on any BGP session authentication and parameters.

   o  Support to enable Layer 3 link liveness detection, such as BFD.

2.4.  Simplicity

   The goal is to provide the minimal set of configuration parameters
   needed by BGP OPEN to successfully start a BGP peering.  The goal is
   specifically not to replace or conflict with data exchanged during
   BGP OPEN.  Multiple sources of truth are a recipe for complexity and
   hence painful errors.

   Simplicity is the key.  Features not absolutely needed will not be
   included in the design.  While the mechanism also needs some
   scalability for information which may be proved necessary in the
   future.

3.  Operator Configuration

   With BGP auto-discovery, some configuration of BGP is still needed.
   Operator configuration should be able to decide at least the
   following:

   o  Select or otherwise filter which peers to actually try to send BGP
      OPEN message.

   o  Decide the parameters to use, e.g.:

   o

      *  IP addressing: IPv4 or IPv6

      *  Interface for peerig: Loopback, or Direct

      *  Any special forwarding or routing needed for reaching the
         prospective peer, e.g., loopback.

      *  AS numbering.

      *  BGP Authentication Options.

4.  Considerations on Design Principles

   This section summarizes the considerations of possible criteria for
   the design of BGP auto-discovery mechanism, which may need further
   discussion in a wider community than the design team (e.g. the IDR
   WG).




Bush, et al.            Expires January 10, 2021                [Page 4]

Internet-Draft    Trade-offs in BGP Peer Auto-Discovery        July 2020


   The network layer of the discovery mechanism:

   o  Layer 2: e.g. basded on ethernet

   o  Layer 3: which is generic for any link-layer protocol

   Relationship with BGP:

   o  Independent from BGP session establishment

   o  Not affect on BGP session establishment and routing exchange,
      other than the interactions for triggering the setup/removal of
      peer session based on discovery mechanism

   o  Make use of existing BGP protocol for automating the BGP session
      bring-up

   Other criteria:

   o  Make use of a currently implemented and deployed protocol in data
      center.

   o  Widely applicable to a range of routing and similar protocols
      which need layer 3 discovery and characterization

   o  Length of the message size supported

   o  Extensibility

5.  Analysis to Candidate Approaches

5.1.  BGP Peer Discovery at Layer Two

   BGP Discovery at Layer-2 would entail finding potential peers on a
   LAN or on Point-to-Point links, discovering their Layer-3 attributes
   such as IP addresses, etc.

   There are two available candidates for peer discovery at Layer-2, one
   is based on Link Layer Discovery Protocol (LLDP), the other one is
   based on Layer 3 Discovery Protocol, L3DL [I-D.ietf-lsvr-l3dl].

5.1.1.  LLDP based Approach

   LLDP is a widely deployed protocol with implementations in most
   devices in data center.  Currently it does not reveal Layer-3
   information such as IP addresses.  LLDP has a limitation of single
   PDU size.  There is an early LLDPv2 development to extend this in
   IEEE.



Bush, et al.            Expires January 10, 2021                [Page 5]

Internet-Draft    Trade-offs in BGP Peer Auto-Discovery        July 2020


   [I-D.acee-idr-lldp-peer-discovery] describes how to use the LLDP IETF
   Organizationally Specific TLV to augment the LLDP TLV set to exchange
   BGP Config Sub-TLVs signaling:

   o  AFI

   o  IP address (IPv4 or IPv6)

   o  Local AS number

   o  Local BGP Identifier (AKA, BGP Router ID)

   o  Session Group-ID

   o  BGP Session Capabilities

   o  Key Chain

   o  Local Address (as BGP Next Hop).

   Which of these are really necessary could be discussed.

5.1.2.  L3DL based Approach

   L3DL [I-D.ietf-lsvr-l3dl] is an ongoing development in the IETF LSVR
   Working Group with the goals of discovering IP Layer-3 attributes of
   links, such as neighbor IP addressing, logical link IP encapsulation
   abilities, and link liveness which may then be disseminated for the
   use of BGP-SPF and similar protocols.

   L3DL Upper Layer Protocol Configuration, [I-D.ymbk-lsvr-l3dl-ulpc],
   details signaling the minimal set of parameters needed to start a BGP
   session with a discovered peer.  Details such as loopback peering are
   handled by attributes in the L3DL protocol itself.  The information
   which can be discovered by L3DL is

   o  AS number

   o  Local IP address, IPv4 or IPv6, and

   o  BGP Authentication.

   L3DL and L3DL-ULPC have well-specified security mechanisms, see
   [I-D.ymbk-lsvr-l3dl-signing].

   The functionality of L3DL-ULPC is similar but not quite the same as
   the needs of IDR Design Team.  E.g., L3DL is designed to meet more
   complex needs.  L3DL's predecessor, LSOE [I-D.ymbk-lsvr-lsoe], was



Bush, et al.            Expires January 10, 2021                [Page 6]

Internet-Draft    Trade-offs in BGP Peer Auto-Discovery        July 2020


   simpler and might be a better candidate for adaptation.  If needed
   the design of LSOE may be customized for the needs of BGP peer auto-
   disovery.

   Unlike LLDP, L3DL has only one implementation, and LSOE has only one
   open source implementation, and neither is significantly deployed.

5.2.  BGP peer Discovery at Layer Three

   Discovery at Layer-3 can assume IP addressability, though the IP
   addresses of potential peers are not known a priori and need to be
   discovered before further negotiation.IP multicast may be a good
   choice to address the above concern.

   The possible problem would appear to discovery at Layer-3 is that one
   may not know whether to use IPv4 or IPv6.  This might be exacerbated
   by the possibility of a potential peer not being on the local subnet,
   and hence broadcast and similar techniques may not be applicable.
   While in data center network or networks in a single administrative
   domain, such issue could be easily solved.

   If one can assume that the BGP session is based on point-to-point
   link, then discovery might try IPv6 link-local or even IPv4 link-
   local.  A link broadcast or multicast protocol may also be used.  For
   switched or bridged multi-point which is at least on the same subnet,
   VLAN, etc., multicast or broadcasts might be a viable approach.

   There are two available candidates for BGP peer discovery at Layer-3,
   one is based on extending BGP with new Hello message for peer auto-
   discovery, the other one is based on reusing BGP OPEN message format
   for peer auto-discovery.

5.2.1.  New BGP Hello Message based Approach

   [I-D.xu-idr-neighbor-autodiscovery] describes a BGP neighbor
   discovery mechanism which is based on a newly defined UDP based BGP
   Hello message.  The BGP Hello message is sent in multicast to
   discover the directly connected BGP peers.  According to the message
   header format and the TLVs carried in the message, the information
   which can be signaled is:

   o  AS number

   o  BGP Identifier

   o  Accepted ASN list

   o  Peering address (IPv4 or IPv6)



Bush, et al.            Expires January 10, 2021                [Page 7]

Internet-Draft    Trade-offs in BGP Peer Auto-Discovery        July 2020


   o  Local prefix (for loopback)

   o  Link attributes

   o  Neighbor state

   o  BGP Authentication

   Which of these are really necessary could be discussed.

5.2.2.  BGP OPEN Message based Approach

   [I-D.raszuk-idr-bgp-auto-session-setup] describes a BGP neighbor
   discovery mechanism by reusing BGP OPEN message format with newly
   defined UDP port.  The message is called BGP Session Explorer (BSE)
   packet and is sent in multicast.  Since the message format is the
   same as BGP OPEN, the information which can be signaled is:

   o  AS number

   o  BGP Identifier

   o  Peering address

5.3.  Discovery at Layer Seven

   Peer discovery at Layer-7 requires application layer rendezvous
   mechanisms analogous to those used by LISP, [RFC6830] or the Bitcoin
   Protocol.

   If the infrastructure is at all complex, e.g. multi-segment or worse,
   then it will need prior routing/forwarding knowledge in order to
   reach the rendezvous.  In a BGP centric deployment this could pose a
   chicken and egg problem.

   Rendezvous approaches may appeal to deployments which favor a central
   control framework.

   On the other hand, those who favor distributed protocols will have
   the classic worries about fragility, redundancy, reliability, etc.

6.  IANA Considerations

   This document makes no request of IANA.

   Note to RFC Editor: this section may be removed on publication as an
   RFC.




Bush, et al.            Expires January 10, 2021                [Page 8]

Internet-Draft    Trade-offs in BGP Peer Auto-Discovery        July 2020


7.  Security Considerations

   None yet, but there will be many.

8.  Acknowledgements

   The IDR BGP Auto-Conf Design Team.

9.  References

9.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

9.2.  Informative References

   [I-D.acee-idr-lldp-peer-discovery]
              Lindem, A., Patel, K., Zandi, S., Haas, J., and X. Xu,
              "BGP Logical Link Discovery Protocol (LLDP) Peer
              Discovery", draft-acee-idr-lldp-peer-discovery-07 (work in
              progress), June 2020.

   [I-D.ietf-lsvr-l3dl]
              Bush, R., Austein, R., and K. Patel, "Layer 3 Discovery
              and Liveness", draft-ietf-lsvr-l3dl-05 (work in progress),
              May 2020.

   [I-D.raszuk-idr-bgp-auto-session-setup]
              Raszuk, R., "BGP Automated Session Setup", draft-raszuk-
              idr-bgp-auto-session-setup-01 (work in progress), December
              2019.

   [I-D.xu-idr-neighbor-autodiscovery]
              Xu, X., Talaulikar, K., Bi, K., Tantsura, J., and N.
              Triantafillis, "BGP Neighbor Discovery", draft-xu-idr-
              neighbor-autodiscovery-12 (work in progress), November
              2019.

   [I-D.ymbk-lsvr-l3dl-signing]
              Bush, R. and R. Austein, "Layer 3 Discovery and Liveness
              Signing", draft-ymbk-lsvr-l3dl-signing-01 (work in
              progress), May 2020.






Bush, et al.            Expires January 10, 2021                [Page 9]

Internet-Draft    Trade-offs in BGP Peer Auto-Discovery        July 2020


   [I-D.ymbk-lsvr-l3dl-ulpc]
              Bush, R. and K. Patel, "L3DL Upper Layer Protocol
              Configuration", draft-ymbk-lsvr-l3dl-ulpc-03 (work in
              progress), May 2020.

   [I-D.ymbk-lsvr-lsoe]
              Bush, R., Austein, R., and K. Patel, "Link State Over
              Ethernet", draft-ymbk-lsvr-lsoe-03 (work in progress),
              November 2018.

Authors' Addresses

   Randy Bush
   Arrcus, Inc. & Internet Initiative Japan
   5147 Crystal Springs
   Bainbridge Island, Washington  98110
   US

   Email: randy@psg.com


   Jie Dong
   Huawei Technologies
   Huawei Campus, No. 156 Beiqing Road.
   Beijing  100095
   China

   Email: jie.dong@huawei.com


   XX




















Bush, et al.            Expires January 10, 2021               [Page 10]
