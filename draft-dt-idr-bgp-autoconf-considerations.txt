



Network Working Group                                            R. Bush
Internet-Draft                  Arrcus, Inc. & Internet Initiative Japan
Intended status: Informational                                   J. Dong
Expires: July 29, 2021                               Huawei Technologies
                                                            J. Haas, Ed.
                                                        Juniper Networks
                                                          W. Kumari, Ed.
                                                                  Google
                                                        January 25, 2021


     Requirements and Considerations in BGP Peer Auto-Configuration
              draft-dt-idr-bgp-autoconf-considerations-00

Abstract

   This draft is an exploration of the requirements, the alternatives,
   and trade-offs in BGP peer auto-discovery at various layers in the
   stack.  It is based on discussions in the IDR WG BGP Autoconf Design
   Team.  The current target environment is the datacenter.

   This document is not intended to become an RFC.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on July 29, 2021.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of



Bush, et al.              Expires July 29, 2021                 [Page 1]

Internet-Draft          BGP Peer Auto-Config Reqs           January 2021


   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Design Team Determinations  . . . . . . . . . . . . . . . . .   2
     2.1.  Problem Scope . . . . . . . . . . . . . . . . . . . . . .   3
     2.2.  Simplicity  . . . . . . . . . . . . . . . . . . . . . . .   3
     2.3.  BGP Auto-Discovery Protocol State Requirements  . . . . .   3
     2.4.  BGP Auto-Discovery Protocol Transport Requirements  . . .   3
   3.  Operator Configuration  . . . . . . . . . . . . . . . . . . .   4
   4.  Considerations on Design Principles . . . . . . . . . . . . .   4
     4.1.  Transport Considerations  . . . . . . . . . . . . . . . .   4
     4.2.  Relationship with BGP . . . . . . . . . . . . . . . . . .   5
   5.  Analysis to Candidate Approaches  . . . . . . . . . . . . . .   5
     5.1.  BGP Peer Discovery at Layer Two . . . . . . . . . . . . .   5
       5.1.1.  LLDP based Approach . . . . . . . . . . . . . . . . .   5
       5.1.2.  L3DL based Approach . . . . . . . . . . . . . . . . .   6
   6.  BGP peer Discovery at Layer Three . . . . . . . . . . . . . .   6
     6.1.  New BGP Hello Message based Approach  . . . . . . . . . .   7
     6.2.  BGP OPEN Message based Approach . . . . . . . . . . . . .   7
     6.3.  Bootstrapping BGP via BGP . . . . . . . . . . . . . . . .   7
     6.4.  Discovery at Layer Seven  . . . . . . . . . . . . . . . .   8
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   8
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .   8
   9.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   8
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .   8
     10.1.  Normative References . . . . . . . . . . . . . . . . . .   8
     10.2.  Informative References . . . . . . . . . . . . . . . . .   9
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  10

1.  Introduction

   This draft is an exploration of the requirements, the alternatives,
   and trade-offs in BGP peer auto-discovery at various layers in the
   stack.  It is based on discussions in the IDR WG BGP Autoconf Design
   Team.  The current target environment is the datacenter.

2.  Design Team Determinations







Bush, et al.              Expires July 29, 2021                 [Page 2]

Internet-Draft          BGP Peer Auto-Config Reqs           January 2021


2.1.  Problem Scope

   The current target environment is BGP as used for the underlay
   routing protocol in data center networks.  Other scenarios may be
   considered as part of the analysis for this work, but work on those
   environments will be deferred to other efforts.

2.2.  Simplicity

   The auto-discovery mechanism is designed to be simple.

   The goal is to select BGP Speakers where a BGP session may be
   successfully negotiated for a particular purpose.  The auto-discovery
   mechanism will not replace or conflict with data exchanged by the BGP
   FSM, including its OPEN message.

2.3.  BGP Auto-Discovery Protocol State Requirements

   o  Support for IPv4 and IPv6 address families, but do not assume that
      both are available.
   o  The ability to use directly attached interface addresses, or the
      device's Loopback address.  When using the Loopback address,
      potentially exchange additional information to bootstrap routing
      to that address.
   o  Discovery of BGP transport protocol end-points and key properties
      such as IP addresses, authentication parameters, layer 3 liveness
      mechanisms such as BFD, and support for GTSM [RFC5082].
   o  Discovery of BGP peer session parameters relevant to peer
      selection such as Autonomous System (AS) Numbers, BGP Identifiers,
      supported address families/subsequent-address families (AFI/
      SAFIs), and device roles.
   o  Device roles are the minimal information available for peer
      selection for a particular application.  While some roles may be
      standardized to provide consistent code points, the expectation is
      that roles will in many cases be user-defined.
   o  Once this information has been learned, a BGP Speaker has the
      necessary information to determine if wishes to open a BGP session
      with the discovered BGP Speaker.
   o  The existing BGP finite-state machine (FSM) will then be leveraged
      to do all further work.

2.4.  BGP Auto-Discovery Protocol Transport Requirements

   BGP Auto-Discovery Protocol State may be carried in multiple
   transport protocols.  That transport protocol may be one that is
   suited for a specific application.





Bush, et al.              Expires July 29, 2021                 [Page 3]

Internet-Draft          BGP Peer Auto-Config Reqs           January 2021


   Implementations supporting more than one transport protocol for this
   state must have a mechanism for consistently selecting discovered BGP
   sessions.  The BGP Identifier, which is carried by the BGP OPEN
   message, can help detect sessions to the same BGP Speaker carried in
   multiple transports.

3.  Operator Configuration

   With BGP auto-discovery, some configuration of BGP is still needed.
   Operator configuration should be able to decide at least the
   following:

   o  Select or otherwise filter which peers to actually try to send BGP
      OPEN message.
   o  Decide the parameters to use, for example:

      *  IP addressing: IPv4 or IPv6
      *  Interface for peerig: Loopback, or Direct
      *  Any special forwarding or routing needed for reaching the
         prospective peer, for example, loopback.
      *  AS numbering.
      *  BGP Authentication Options.

4.  Considerations on Design Principles

   This section summarizes the considerations of possible criteria for
   the design of BGP auto-discovery mechanism, which may need further
   discussion in a wider community than the design team (for example,
   the IDR WG).

4.1.  Transport Considerations

   The network layer of the discovery mechanism.  This may impact the
   scoping of the deployment of the auto-discovery mechanism.

   o  Layer 2: For example, based on ethernet.
   o  Layer 3: Which is generic for any link-layer protocol.

   Potentially leveraging existing protocols deployed in the data
   center.

   The length of message supported by the protocol.

   How extensible the protocol is to carry future state for BGP auto-
   configuration.






Bush, et al.              Expires July 29, 2021                 [Page 4]

Internet-Draft          BGP Peer Auto-Config Reqs           January 2021


4.2.  Relationship with BGP

   o  The auto-discovery mechanism should be independent from BGP
      session establishment of the discovered session.
   o  Not affect on BGP session establishment and routing exchange,
      other than the interactions for triggering the setup/removal of
      peer session based on discovery mechanism.
   o  Potentially leveraging existing BGP protocol sessions for
      discovery of new BGP sessions.

5.  Analysis to Candidate Approaches

5.1.  BGP Peer Discovery at Layer Two

   BGP Discovery at Layer-2 would entail finding potential peers on a
   LAN or on Point-to-Point links, discovering their Layer-3 attributes
   such as IP addresses, etc.

   There are two available candidates for peer discovery at Layer-2, one
   is based on Link Layer Discovery Protocol (LLDP), the other one is
   based on Layer 3 Discovery Protocol, L3DL [I-D.ietf-lsvr-l3dl].

5.1.1.  LLDP based Approach

   LLDP is a widely deployed protocol with implementations in most
   devices in data center.  Currently it does not reveal Layer-3
   information such as IP addresses.  LLDP has a limitation of single
   PDU size.  There is an early LLDPv2 development to extend this in
   IEEE.

   [I-D.acee-idr-lldp-peer-discovery] describes how to use the LLDP IETF
   Organizationally Specific TLV to augment the LLDP TLV set to exchange
   BGP Config Sub-TLVs signaling:

   o  AFI
   o  IP address (IPv4 or IPv6)
   o  Local AS number
   o  Local BGP Identifier (AKA, BGP Router ID)
   o  Session Group-ID
   o  BGP Session Capabilities
   o  Key Chain
   o  Local Address (as BGP Next Hop).

   Which of these are really necessary could be discussed.







Bush, et al.              Expires July 29, 2021                 [Page 5]

Internet-Draft          BGP Peer Auto-Config Reqs           January 2021


5.1.2.  L3DL based Approach

   L3DL [I-D.ietf-lsvr-l3dl] is an ongoing development in the IETF LSVR
   Working Group with the goals of discovering IP Layer-3 attributes of
   links, such as neighbor IP addressing, logical link IP encapsulation
   abilities, and link liveness which may then be disseminated for the
   use of BGP-SPF and similar protocols.

   L3DL Upper Layer Protocol Configuration, [I-D.ietf-lsvr-l3dl-ulpc],
   details signaling the minimal set of parameters needed to start a BGP
   session with a discovered peer.  Details such as loopback peering are
   handled by attributes in the L3DL protocol itself.  The information
   which can be discovered by L3DL is

   o  AS number
   o  Local IP address, IPv4 or IPv6, and
   o  BGP Authentication.

   L3DL and L3DL-ULPC have well-specified security mechanisms, see
   [I-D.ietf-lsvr-l3dl-signing].

   The functionality of L3DL-ULPC is similar but not quite the same as
   the needs of IDR Design Team.  E.g., L3DL is designed to meet more
   complex needs.  L3DL's predecessor, LSOE [I-D.ietf-lsvr-lsoe], was
   simpler and might be a better candidate for adaptation.  If needed
   the design of LSOE may be customized for the needs of BGP peer auto-
   disovery.

   Unlike LLDP, L3DL has only one implementation, and LSOE has only one
   open source implementation, and neither is significantly deployed.

6.  BGP peer Discovery at Layer Three

   Discovery at Layer-3 can assume IP addressability, though the IP
   addresses of potential peers are not known a priori and need to be
   discovered before further negotiation.  IP multicast may be a good
   choice to address the above concern.

   The possible problem would appear to discovery at Layer-3 is that one
   may not know whether to use IPv4 or IPv6.  This might be exacerbated
   by the possibility of a potential peer not being on the local subnet,
   and hence broadcast and similar techniques may not be applicable.
   While in data center network or networks in a single administrative
   domain, such issue could be easily solved.

   If one can assume that the BGP session is based on point-to-point
   link, then discovery might try IPv6 link-local or even IPv4 link-
   local.  A link broadcast or multicast protocol may also be used.  For



Bush, et al.              Expires July 29, 2021                 [Page 6]

Internet-Draft          BGP Peer Auto-Config Reqs           January 2021


   switched or bridged multi-point which is at least on the same subnet,
   VLAN, etc., multicast or broadcasts might be a viable approach.

   There are two available candidates for BGP peer discovery at Layer-3,
   one is based on extending BGP with new Hello message for peer auto-
   discovery, the other one is based on reusing BGP OPEN message format
   for peer auto-discovery.

6.1.  New BGP Hello Message based Approach

   [I-D.xu-idr-neighbor-autodiscovery] describes a BGP neighbor
   discovery mechanism which is based on a newly defined UDP based BGP
   Hello message.  The BGP Hello message is sent in multicast to
   discover the directly connected BGP peers.  According to the message
   header format and the TLVs carried in the message, the information
   which can be signaled is:

   o  AS number
   o  BGP Identifier
   o  Accepted ASN list
   o  Peering address (IPv4 or IPv6)
   o  Local prefix (for loopback)
   o  Link attributes
   o  Neighbor state
   o  BGP Authentication

   Which of these are really necessary could be discussed.

6.2.  BGP OPEN Message based Approach

   [I-D.raszuk-idr-bgp-auto-session-setup] describes a BGP neighbor
   discovery mechanism by reusing BGP OPEN message format with newly
   defined UDP port.  The message is called BGP Session Explorer (BSE)
   packet and is sent in multicast.  Since the message format is the
   same as BGP OPEN, the information which can be signaled is:

   o  AS number
   o  BGP Identifier
   o  Peering address

6.3.  Bootstrapping BGP via BGP

   [I-D.raszuk-idr-bgp-auto-discovery] describes a new BGP address
   family.  The NLRI carries a Group ID + BGP Identifier as the key.  A
   new BGP Path Attribute carries information about the sessions:

   o  AS Number
   o  AFI/SAFI



Bush, et al.              Expires July 29, 2021                 [Page 7]

Internet-Draft          BGP Peer Auto-Config Reqs           January 2021


   o  BGP Identifier
   o  Peer Transport Address
   o  Flags to declare a session for information only, to force a reset
      of a session on parameter changes, etc.

6.4.  Discovery at Layer Seven

   Peer discovery at Layer-7 requires application layer rendezvous
   mechanisms analogous to those used by LISP, [RFC6830] or the Bitcoin
   Protocol.

   If the infrastructure is at all complex, for example, multi-segment
   or worse, then it will need prior routing/forwarding knowledge in
   order to reach the rendezvous.  In a BGP centric deployment this
   could pose a chicken and egg problem.

   Rendezvous approaches may appeal to deployments which favor a central
   control framework.

   On the other hand, those who favor distributed protocols will have
   the classic worries about fragility, redundancy, reliability, etc.

7.  IANA Considerations

   This document makes no request of IANA.

   Note to RFC Editor: this section may be removed on publication as an
   RFC.

8.  Security Considerations

   None yet, but there will be many.

9.  Acknowledgments

   The IDR BGP Auto-Conf Design Team.

10.  References

10.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.






Bush, et al.              Expires July 29, 2021                 [Page 8]

Internet-Draft          BGP Peer Auto-Config Reqs           January 2021


10.2.  Informative References

   [I-D.acee-idr-lldp-peer-discovery]
              Lindem, A., Patel, K., Zandi, S., Haas, J., and X. Xu,
              "BGP Logical Link Discovery Protocol (LLDP) Peer
              Discovery", draft-acee-idr-lldp-peer-discovery-08 (work in
              progress), December 2020.

   [I-D.ietf-lsvr-l3dl]
              Bush, R., Austein, R., and K. Patel, "Layer 3 Discovery
              and Liveness", draft-ietf-lsvr-l3dl-06 (work in progress),
              July 2020.

   [I-D.ietf-lsvr-l3dl-signing]
              Bush, R. and R. Austein, "Layer 3 Discovery and Liveness
              Signing", draft-ietf-lsvr-l3dl-signing-00 (work in
              progress), May 2020.

   [I-D.ietf-lsvr-l3dl-ulpc]
              Bush, R. and K. Patel, "L3DL Upper Layer Protocol
              Configuration", draft-ietf-lsvr-l3dl-ulpc-00 (work in
              progress), May 2020.

   [I-D.ietf-lsvr-lsoe]
              Bush, R., Austein, R., and K. Patel, "Link State Over
              Ethernet", draft-ietf-lsvr-lsoe-01 (work in progress),
              February 2019.

   [I-D.raszuk-idr-bgp-auto-discovery]
              Raszuk, R., Mitchell, J., Kumari, W., Patel, K., and J.
              Scudder, "BGP Auto Discovery", draft-raszuk-idr-bgp-auto-
              discovery-06 (work in progress), December 2019.

   [I-D.raszuk-idr-bgp-auto-session-setup]
              Raszuk, R., "BGP Automated Session Setup", draft-raszuk-
              idr-bgp-auto-session-setup-01 (work in progress), December
              2019.

   [I-D.xu-idr-neighbor-autodiscovery]
              Xu, X., Talaulikar, K., Bi, K., Tantsura, J., and N.
              Triantafillis, "BGP Neighbor Discovery", draft-xu-idr-
              neighbor-autodiscovery-12 (work in progress), November
              2019.

   [RFC5082]  Gill, V., Heasley, J., Meyer, D., Savola, P., Ed., and C.
              Pignataro, "The Generalized TTL Security Mechanism
              (GTSM)", RFC 5082, DOI 10.17487/RFC5082, October 2007,
              <https://www.rfc-editor.org/info/rfc5082>.



Bush, et al.              Expires July 29, 2021                 [Page 9]

Internet-Draft          BGP Peer Auto-Config Reqs           January 2021


   [RFC6830]  Farinacci, D., Fuller, V., Meyer, D., and D. Lewis, "The
              Locator/ID Separation Protocol (LISP)", RFC 6830,
              DOI 10.17487/RFC6830, January 2013,
              <https://www.rfc-editor.org/info/rfc6830>.

Authors' Addresses

   Randy Bush
   Arrcus, Inc. & Internet Initiative Japan
   5147 Crystal Springs
   Bainbridge Island, WA  98110
   US

   Email: randy@psg.com


   Jie Dong
   Huawei Technologies
   Huawei Campus, No. 156 Beiqing Road
   Beijing  100095
   China

   Email: jie.dong@huawei.com


   Jeffrey Haas (editor)
   Juniper Networks
   1133 Innovation Way
   Sunnyvale, CA  94089
   US

   Email: jhaas@juniper.net


   Warren Kumari (editor)
   Google
   1600 Amphitheatre Parkway
   Mountain View, CA  94043
   US

   Email: warren@kumari.net










Bush, et al.              Expires July 29, 2021                [Page 10]
